<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveQueen - Premium Online Shop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'loewe': ['Helvetica Neue', 'Arial', 'sans-serif']
                    },
                    colors: {
                        'loewe-beige': '#f5f4f2',
                        'loewe-brown': '#8b7355',
                        'loewe-black': '#1a1a1a',
                        'loewe-gray': '#666666',
                        'admin-blue': '#3b82f6'
                    }
                }
            }
        }
    </script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-loewe-beige font-loewe">
    <!-- 管理者ツールバー（ログイン時のみ表示） -->
    <div id="adminToolbar" class="hidden bg-admin-blue text-white py-2">
        <div class="max-w-7xl mx-auto px-6 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <i class="fas fa-tools"></i>
                <span class="text-sm">管理者モード</span>
            </div>
            <div class="flex items-center space-x-4">
                <button onclick="showAdminPanel()" class="text-sm hover:underline">
                    <i class="fas fa-cog mr-1"></i>管理画面
                </button>
                <button onclick="toggleEditMode()" id="editModeBtn" class="text-sm hover:underline">
                    <i class="fas fa-edit mr-1"></i>編集モード: OFF
                </button>
                <button onclick="adminLogout()" class="text-sm hover:underline">
                    <i class="fas fa-sign-out-alt mr-1"></i>ログアウト
                </button>
            </div>
        </div>
    </div>

    <!-- メインヘッダー -->
    <header class="bg-white border-b border-gray-200 relative">
        <div class="max-w-6xl mx-auto px-6">
            <div class="flex items-center justify-between h-20">
                <div class="flex items-center">
                    <h1 class="text-3xl font-light tracking-wider text-loewe-black uppercase cursor-pointer" onclick="goHome()">
                        <span id="siteName" class="editable" data-field="siteName">LoveQueen</span>
                    </h1>
                </div>
                <nav class="hidden md:flex space-x-12">
                    <a href="#" onclick="showSection('collection')" class="text-loewe-gray hover:text-loewe-black transition-colors text-sm uppercase tracking-wide">Collection</a>
                    <a href="#" onclick="showSection('categories')" class="text-loewe-gray hover:text-loewe-black transition-colors text-sm uppercase tracking-wide">Categories</a>
                    <a href="#" onclick="showSection('about')" class="text-loewe-gray hover:text-loewe-black transition-colors text-sm uppercase tracking-wide">About</a>
                    <a href="#" onclick="showSection('contact')" class="text-loewe-gray hover:text-loewe-black transition-colors text-sm uppercase tracking-wide">Contact</a>
                </nav>
                <div class="flex items-center space-x-8">
                    <button id="cartButton" onclick="openCart()" class="relative text-loewe-gray hover:text-loewe-black transition-colors">
                        <i class="fas fa-shopping-bag text-lg"></i>
                        <span id="cartCount" class="absolute -top-1 -right-1 bg-loewe-brown text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hidden">0</span>
                    </button>
                    <div id="authButtons" class="flex space-x-6">
                        <button id="loginButton" onclick="openLoginModal()" class="text-loewe-gray hover:text-loewe-black transition-colors text-sm uppercase tracking-wide">
                            Sign In
                        </button>
                        <button id="registerButton" onclick="openRegisterModal()" class="text-loewe-gray hover:text-loewe-black transition-colors text-sm uppercase tracking-wide">
                            Register
                        </button>
                    </div>
                    <div id="userMenu" class="hidden relative">
                        <button id="userMenuButton" class="flex items-center text-loewe-gray hover:text-loewe-black transition-colors">
                            <i class="fas fa-user mr-2"></i>
                            <span id="userName" class="text-sm uppercase tracking-wide">Account</span>
                            <i class="fas fa-chevron-down ml-2 text-xs"></i>
                        </button>
                        <div id="userDropdown" class="hidden absolute right-0 mt-3 w-48 bg-white border border-gray-200 shadow-lg z-50 rounded-md">
                            <div class="py-2">
                                <a href="#" onclick="showProfile()" class="block px-4 py-3 text-xs text-loewe-gray hover:text-loewe-black hover:bg-gray-50 uppercase tracking-wide">
                                    Profile
                                </a>
                                <a href="#" onclick="showOrders()" class="block px-4 py-3 text-xs text-loewe-gray hover:text-loewe-black hover:bg-gray-50 uppercase tracking-wide">
                                    Orders
                                </a>
                                <div id="adminMenuItems" class="hidden">
                                    <hr class="border-gray-100">
                                    <a href="#" onclick="showAdminPanel()" class="block px-4 py-3 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 uppercase tracking-wide">
                                        <i class="fas fa-cog mr-2"></i>Admin Panel
                                    </a>
                                </div>
                                <hr class="border-gray-100">
                                <a href="#" onclick="logout()" class="block px-4 py-3 text-xs text-loewe-gray hover:text-loewe-black hover:bg-gray-50 uppercase tracking-wide">
                                    Sign Out
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 編集モード用の商品追加ボタン -->
        <div id="addProductFab" class="hidden fixed bottom-6 right-6 z-50">
            <button onclick="openProductModal()" class="bg-admin-blue text-white rounded-full w-14 h-14 shadow-lg hover:bg-blue-600 transition-colors">
                <i class="fas fa-plus text-xl"></i>
            </button>
        </div>
    </header>

    <!-- メインコンテンツ -->
    <main class="max-w-6xl mx-auto px-6">
        <!-- ホームセクション -->
        <section id="homeSection" class="section-content">
            <!-- ヒーローセクション -->
            <div class="py-20 text-center border-b border-gray-200 relative">
                <div class="max-w-2xl mx-auto">
                    <h2 class="text-6xl font-light text-loewe-black mb-8 tracking-wider uppercase">
                        <span id="heroTitle" class="editable" data-field="heroTitle">Autumn<br>Collection</span>
                    </h2>
                    <p class="text-lg text-loewe-gray mb-12 leading-relaxed">
                        <span id="heroDescription" class="editable" data-field="heroDescription">
                            Discover our carefully curated selection of premium goods,<br>
                            crafted with exceptional attention to detail.
                        </span>
                    </p>
                    <button onclick="showSection('collection')" class="border border-loewe-black text-loewe-black px-8 py-4 text-sm uppercase tracking-wider hover:bg-loewe-black hover:text-white transition-all duration-300">
                        <span id="heroButton" class="editable" data-field="heroButton">Explore Collection</span>
                    </button>
                </div>
                <!-- 編集ボタン（編集モード時のみ表示） -->
                <div class="edit-controls hidden absolute top-4 right-4">
                    <button onclick="editHeroSection()" class="bg-admin-blue text-white px-3 py-1 rounded text-sm">
                        <i class="fas fa-edit mr-1"></i>Edit Hero
                    </button>
                </div>
            </div>

            <!-- カテゴリセクション -->
            <div class="py-16 border-b border-gray-200 relative">
                <h3 class="text-2xl font-light text-loewe-black mb-12 text-center uppercase tracking-wider">
                    <span id="categoriesTitle" class="editable" data-field="categoriesTitle">Categories</span>
                </h3>
                <div id="categoriesContainer" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-8">
                    <!-- カテゴリがここに動的に表示されます -->
                </div>
                <!-- 編集ボタン（編集モード時のみ表示） -->
                <div class="edit-controls hidden absolute top-4 right-4">
                    <button onclick="openCategoryModal()" class="bg-admin-blue text-white px-3 py-1 rounded text-sm mr-2">
                        <i class="fas fa-plus mr-1"></i>Add Category
                    </button>
                    <button onclick="editCategories()" class="bg-admin-blue text-white px-3 py-1 rounded text-sm">
                        <i class="fas fa-edit mr-1"></i>Edit
                    </button>
                </div>
            </div>

            <!-- 人気商品セクション -->
            <div class="py-16 relative">
                <h3 class="text-2xl font-light text-loewe-black mb-12 text-center uppercase tracking-wider">
                    <span id="featuredTitle" class="editable" data-field="featuredTitle">Featured Products</span>
                </h3>
                <div id="featuredProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12">
                    <!-- 人気商品がここに動的に表示されます -->
                </div>
                <!-- 編集ボタン（編集モード時のみ表示） -->
                <div class="edit-controls hidden absolute top-4 right-4">
                    <button onclick="manageFeatured()" class="bg-admin-blue text-white px-3 py-1 rounded text-sm">
                        <i class="fas fa-star mr-1"></i>Manage Featured
                    </button>
                </div>
            </div>
        </section>

        <!-- 商品一覧セクション -->
        <section id="collectionSection" class="section-content hidden py-16 border-t border-gray-200">
            <div class="flex justify-between items-center mb-12">
                <h3 class="text-2xl font-light text-loewe-black uppercase tracking-wider">All Products</h3>
                <div class="flex items-center space-x-6">
                    <select id="sortSelect" class="border border-gray-300 px-4 py-2 text-sm text-loewe-gray bg-white rounded" onchange="sortProducts()">
                        <option value="newest">Newest First</option>
                        <option value="price_asc">Price: Low to High</option>
                        <option value="price_desc">Price: High to Low</option>
                        <option value="name">Alphabetical</option>
                        <option value="featured">Featured First</option>
                    </select>
                    <div class="relative">
                        <input id="searchInput" type="text" placeholder="Search products..." 
                               class="border border-gray-300 px-4 py-2 text-sm text-loewe-gray bg-white w-64 rounded pl-10"
                               onkeyup="searchProducts(event)">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>
                </div>
            </div>
            
            <!-- フィルター -->
            <div class="mb-8 flex flex-wrap gap-4">
                <select id="categoryFilter" class="border border-gray-300 px-4 py-2 text-sm bg-white rounded" onchange="filterProducts()">
                    <option value="">All Categories</option>
                </select>
                <select id="priceFilter" class="border border-gray-300 px-4 py-2 text-sm bg-white rounded" onchange="filterProducts()">
                    <option value="">All Prices</option>
                    <option value="0-5000">¥0 - ¥5,000</option>
                    <option value="5000-10000">¥5,000 - ¥10,000</option>
                    <option value="10000-20000">¥10,000 - ¥20,000</option>
                    <option value="20000-50000">¥20,000 - ¥50,000</option>
                    <option value="50000+">¥50,000+</option>
                </select>
                <button onclick="clearFilters()" class="text-loewe-gray hover:text-loewe-black text-sm">
                    <i class="fas fa-times mr-1"></i>Clear Filters
                </button>
            </div>
            
            <div id="productsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12">
                <!-- 商品がここに動的に表示されます -->
            </div>
            
            <!-- Load More / Pagination -->
            <div id="loadMoreSection" class="text-center mt-16">
                <button id="loadMoreBtn" onclick="loadMoreProducts()" 
                        class="border border-loewe-black text-loewe-black px-8 py-4 text-sm uppercase tracking-wide hover:bg-loewe-black hover:text-white transition-all">
                    Load More Products
                </button>
            </div>
        </section>

        <!-- その他のセクション -->
        <section id="categoriesSection" class="section-content hidden py-16">
            <h2 class="text-3xl font-light text-loewe-black mb-12 text-center uppercase tracking-wider">Shop by Category</h2>
            <div id="allCategoriesContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- 全カテゴリがここに表示 -->
            </div>
        </section>

        <section id="aboutSection" class="section-content hidden py-16">
            <div class="max-w-4xl mx-auto text-center">
                <h2 class="text-3xl font-light text-loewe-black mb-8 uppercase tracking-wider">About LoveQueen</h2>
                <div class="prose prose-lg mx-auto">
                    <p class="text-loewe-gray leading-relaxed mb-6">
                        <span id="aboutText" class="editable" data-field="aboutText">
                            LoveQueen represents the pinnacle of contemporary luxury, where exceptional craftsmanship meets timeless design. 
                            Our carefully curated collection celebrates the art of fine living through meticulously selected pieces that 
                            define modern elegance.
                        </span>
                    </p>
                </div>
            </div>
        </section>

        <section id="contactSection" class="section-content hidden py-16">
            <div class="max-w-2xl mx-auto">
                <h2 class="text-3xl font-light text-loewe-black mb-12 text-center uppercase tracking-wider">Contact Us</h2>
                <form id="contactForm" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-loewe-black mb-2">Name</label>
                        <input type="text" name="name" required class="w-full border border-gray-300 px-4 py-3 rounded focus:outline-none focus:border-loewe-brown">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-loewe-black mb-2">Email</label>
                        <input type="email" name="email" required class="w-full border border-gray-300 px-4 py-3 rounded focus:outline-none focus:border-loewe-brown">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-loewe-black mb-2">Message</label>
                        <textarea name="message" rows="6" required class="w-full border border-gray-300 px-4 py-3 rounded focus:outline-none focus:border-loewe-brown"></textarea>
                    </div>
                    <button type="submit" class="w-full bg-loewe-black text-white py-4 text-sm uppercase tracking-wider hover:bg-loewe-brown transition-colors">
                        Send Message
                    </button>
                </form>
            </div>
        </section>
    </main>

    <!-- フッター -->
    <footer class="bg-white border-t border-gray-200 py-16 mt-20">
        <div class="max-w-6xl mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12">
                <!-- ブランド情報 -->
                <div class="md:col-span-2">
                    <h3 class="text-2xl font-light text-loewe-black mb-6 uppercase tracking-wider">
                        <span id="footerBrand" class="editable" data-field="footerBrand">LoveQueen</span>
                    </h3>
                    <p class="text-loewe-gray leading-relaxed mb-6">
                        <span id="footerDescription" class="editable" data-field="footerDescription">
                            Exceptional craftsmanship meets contemporary design.<br>
                            Discover timeless pieces that define luxury.
                        </span>
                    </p>
                    <p class="text-xs text-loewe-gray uppercase tracking-wide">© 2024 LoveQueen. All rights reserved.</p>
                </div>
                
                <!-- リンク -->
                <div>
                    <h4 class="text-sm font-medium text-loewe-black mb-6 uppercase tracking-wide">Services</h4>
                    <ul class="space-y-3">
                        <li><a href="#" onclick="showSection('collection')" class="text-loewe-gray hover:text-loewe-black text-sm transition-colors">Collection</a></li>
                        <li><a href="#" onclick="showSection('contact')" class="text-loewe-gray hover:text-loewe-black text-sm transition-colors">Contact</a></li>
                        <li><a href="#" class="text-loewe-gray hover:text-loewe-black text-sm transition-colors">Terms</a></li>
                        <li><a href="#" class="text-loewe-gray hover:text-loewe-black text-sm transition-colors">Privacy</a></li>
                    </ul>
                </div>
                
                <!-- SNS -->
                <div>
                    <h4 class="text-sm font-medium text-loewe-black mb-6 uppercase tracking-wide">Follow</h4>
                    <div id="socialLinks" class="flex space-x-4">
                        <!-- SNSリンクがここに動的に表示されます -->
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- ショッピングカートサイドバー -->
    <div id="cartSidebar" class="fixed inset-y-0 right-0 w-96 bg-white shadow-2xl transform translate-x-full transition-transform duration-300 ease-in-out z-50">
        <div class="flex flex-col h-full">
            <div class="flex items-center justify-between p-6 border-b">
                <h3 class="text-lg font-medium">Shopping Cart</h3>
                <button onclick="closeCart()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="cartItems" class="flex-1 overflow-y-auto p-6">
                <!-- カート商品がここに表示 -->
            </div>
            
            <div class="border-t p-6">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-lg font-medium">Total:</span>
                    <span id="cartTotal" class="text-xl font-bold">¥0</span>
                </div>
                <button id="checkoutBtn" onclick="proceedToCheckout()" 
                        class="w-full bg-loewe-black text-white py-3 text-sm uppercase tracking-wider hover:bg-loewe-brown transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed"
                        disabled>
                    Proceed to Checkout
                </button>
                <button onclick="clearCart()" class="w-full mt-2 text-loewe-gray hover:text-loewe-black text-sm">
                    Clear Cart
                </button>
            </div>
        </div>
    </div>

    <!-- 管理者パネル -->
    <div id="adminPanel" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-screen overflow-y-auto">
                <div class="flex items-center justify-between p-6 border-b">
                    <h2 class="text-2xl font-bold">Admin Panel - LoveQueen</h2>
                    <button onclick="closeAdminPanel()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="p-6">
                    <!-- 管理タブ -->
                    <div class="flex space-x-1 mb-8 bg-gray-100 p-1 rounded-lg">
                        <button onclick="showAdminTab('products')" class="admin-tab-btn active" data-tab="products">
                            <i class="fas fa-box mr-2"></i>Products
                        </button>
                        <button onclick="showAdminTab('orders')" class="admin-tab-btn" data-tab="orders">
                            <i class="fas fa-shopping-cart mr-2"></i>Orders
                        </button>
                        <button onclick="showAdminTab('customers')" class="admin-tab-btn" data-tab="customers">
                            <i class="fas fa-users mr-2"></i>Customers
                        </button>
                        <button onclick="showAdminTab('analytics')" class="admin-tab-btn" data-tab="analytics">
                            <i class="fas fa-chart-bar mr-2"></i>Analytics
                        </button>
                        <button onclick="showAdminTab('settings')" class="admin-tab-btn" data-tab="settings">
                            <i class="fas fa-cog mr-2"></i>Settings
                        </button>
                    </div>

                    <!-- 商品管理タブ -->
                    <div id="adminProductsTab" class="admin-tab-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold">Product Management</h3>
                            <button onclick="openProductModal()" class="bg-admin-blue text-white px-4 py-2 rounded hover:bg-blue-600">
                                <i class="fas fa-plus mr-2"></i>Add Product
                            </button>
                        </div>
                        
                        <div class="bg-white border rounded-lg overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Price</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="adminProductsTable" class="bg-white divide-y divide-gray-200">
                                        <!-- 商品データがここに表示 -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- その他のタブ内容 -->
                    <div id="adminOrdersTab" class="admin-tab-content hidden">
                        <h3 class="text-xl font-semibold mb-6">Order Management</h3>
                        <div id="adminOrdersTable">
                            <!-- 注文データがここに表示 -->
                        </div>
                    </div>

                    <div id="adminCustomersTab" class="admin-tab-content hidden">
                        <h3 class="text-xl font-semibold mb-6">Customer Management</h3>
                        <div id="adminCustomersTable">
                            <!-- 顧客データがここに表示 -->
                        </div>
                    </div>

                    <div id="adminAnalyticsTab" class="admin-tab-content hidden">
                        <h3 class="text-xl font-semibold mb-6">Analytics & Reports</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="bg-blue-50 p-6 rounded-lg">
                                <div class="text-2xl font-bold text-blue-600" id="totalSales">¥0</div>
                                <div class="text-sm text-gray-600">Total Sales</div>
                            </div>
                            <div class="bg-green-50 p-6 rounded-lg">
                                <div class="text-2xl font-bold text-green-600" id="totalOrders">0</div>
                                <div class="text-sm text-gray-600">Total Orders</div>
                            </div>
                            <div class="bg-yellow-50 p-6 rounded-lg">
                                <div class="text-2xl font-bold text-yellow-600" id="totalProducts">0</div>
                                <div class="text-sm text-gray-600">Total Products</div>
                            </div>
                            <div class="bg-purple-50 p-6 rounded-lg">
                                <div class="text-2xl font-bold text-purple-600" id="totalCustomers">0</div>
                                <div class="text-sm text-gray-600">Total Customers</div>
                            </div>
                        </div>
                    </div>

                    <div id="adminSettingsTab" class="admin-tab-content hidden">
                        <h3 class="text-xl font-semibold mb-6">Site Settings</h3>
                        <form id="siteSettingsForm" class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Site Name</label>
                                <input type="text" id="settingSiteName" class="w-full border border-gray-300 rounded-md px-4 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Site Description</label>
                                <textarea id="settingSiteDescription" rows="3" class="w-full border border-gray-300 rounded-md px-4 py-2"></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Contact Email</label>
                                <input type="email" id="settingContactEmail" class="w-full border border-gray-300 rounded-md px-4 py-2">
                            </div>
                            <button type="submit" class="bg-admin-blue text-white px-6 py-2 rounded hover:bg-blue-600">
                                Save Settings
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 商品追加/編集モーダル -->
    <div id="productModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-screen overflow-y-auto">
                <div class="flex items-center justify-between p-6 border-b">
                    <h3 id="productModalTitle" class="text-xl font-bold">Add New Product</h3>
                    <button onclick="closeProductModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <form id="productForm" class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- 基本情報 -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Product Name *</label>
                            <input type="text" id="productName" name="name" required class="w-full border border-gray-300 rounded-md px-4 py-2">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Price (¥) *</label>
                            <input type="number" id="productPrice" name="price" required class="w-full border border-gray-300 rounded-md px-4 py-2">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Category *</label>
                            <select id="productCategory" name="category_id" required class="w-full border border-gray-300 rounded-md px-4 py-2">
                                <option value="">Select Category</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">SKU</label>
                            <input type="text" id="productSku" name="sku" class="w-full border border-gray-300 rounded-md px-4 py-2">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Stock Quantity</label>
                            <input type="number" id="productStock" name="stock" value="0" class="w-full border border-gray-300 rounded-md px-4 py-2">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Weight (g)</label>
                            <input type="number" id="productWeight" name="weight" class="w-full border border-gray-300 rounded-md px-4 py-2">
                        </div>
                        
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                            <textarea id="productDescription" name="description" rows="4" class="w-full border border-gray-300 rounded-md px-4 py-2"></textarea>
                        </div>
                        
                        <!-- 画像アップロード -->
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Product Images</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6">
                                <input type="file" id="productImages" multiple accept="image/*" class="hidden" onchange="previewImages(this)">
                                <div id="imagePreviewContainer" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 hidden">
                                    <!-- 画像プレビューがここに表示 -->
                                </div>
                                <div id="imageUploadArea" class="text-center">
                                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                                    <p class="text-gray-600 mb-2">Drag & drop images or</p>
                                    <button type="button" onclick="document.getElementById('productImages').click()" 
                                            class="bg-admin-blue text-white px-4 py-2 rounded hover:bg-blue-600">
                                        Select Images
                                    </button>
                                    <p class="text-xs text-gray-500 mt-2">PNG, JPG, GIF up to 10MB each</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 商品オプション -->
                        <div class="md:col-span-2">
                            <div class="grid grid-cols-2 gap-4">
                                <label class="flex items-center">
                                    <input type="checkbox" id="productFeatured" name="is_featured" class="mr-2">
                                    <span class="text-sm font-medium text-gray-700">Featured Product</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="productActive" name="is_active" checked class="mr-2">
                                    <span class="text-sm font-medium text-gray-700">Published</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between mt-8 pt-6 border-t">
                        <div>
                            <button type="button" id="deleteProductBtn" onclick="deleteProduct()" 
                                    class="hidden bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700">
                                <i class="fas fa-trash mr-2"></i>Delete Product
                            </button>
                        </div>
                        <div class="flex space-x-4">
                            <button type="button" onclick="closeProductModal()" class="bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600">
                                Cancel
                            </button>
                            <button type="submit" class="bg-admin-blue text-white px-6 py-2 rounded hover:bg-blue-600">
                                <i class="fas fa-save mr-2"></i>Save Product
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- その他のモーダル -->
    <div id="loginModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 z-50">
        <!-- ログインモーダルの内容 -->
    </div>

    <div id="registerModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 z-50">
        <!-- 登録モーダルの内容 -->
    </div>

    <!-- カートオーバーレイ -->
    <div id="cartOverlay" class="fixed inset-0 bg-gray-900 bg-opacity-50 z-40 hidden" onclick="closeCart()"></div>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <script>
        // グローバル変数
        let currentUser = null;
        let products = [];
        let categories = [];
        let cart = [];
        let isEditMode = false;
        let currentPage = 1;
        const productsPerPage = 9;

        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            loadSampleData();
            loadCartFromStorage();
            updateCartUI();
            loadFeaturedProducts();
            loadCategories();
            checkUserSession();
            setupEventListeners();
        }

        // サンプルデータの読み込み
        function loadSampleData() {
            // サンプル商品データ
            products = [
                {
                    id: 1,
                    name: "Premium Leather Handbag",
                    price: 45800,
                    category_id: 1,
                    category_name: "Accessories",
                    description: "Crafted from the finest Italian leather, this sophisticated handbag embodies timeless elegance and functionality.",
                    image_url: "https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=400&h=400&fit=crop",
                    stock: 15,
                    is_featured: true,
                    is_active: true,
                    sku: "LQ-BAG-001",
                    created_at: "2024-01-15"
                },
                {
                    id: 2,
                    name: "Cashmere Wool Coat",
                    price: 89000,
                    category_id: 2,
                    category_name: "Outerwear",
                    description: "Luxurious cashmere wool coat with minimalist design, perfect for autumn and winter seasons.",
                    image_url: "https://images.unsplash.com/photo-1544022613-e87ca75a784a?w=400&h=400&fit=crop",
                    stock: 8,
                    is_featured: true,
                    is_active: true,
                    sku: "LQ-COAT-001",
                    created_at: "2024-01-20"
                },
                {
                    id: 3,
                    name: "Sterling Silver Watch",
                    price: 125000,
                    category_id: 1,
                    category_name: "Accessories",
                    description: "Precision-crafted timepiece with sterling silver case and leather strap, embodying understated luxury.",
                    image_url: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=400&h=400&fit=crop",
                    stock: 12,
                    is_featured: false,
                    is_active: true,
                    sku: "LQ-WATCH-001",
                    created_at: "2024-01-25"
                },
                {
                    id: 4,
                    name: "Silk Scarf Collection",
                    price: 18500,
                    category_id: 1,
                    category_name: "Accessories",
                    description: "Hand-painted silk scarf featuring exclusive patterns inspired by nature and art.",
                    image_url: "https://images.unsplash.com/photo-1601924994987-69e26d50dc26?w=400&h=400&fit=crop",
                    stock: 25,
                    is_featured: true,
                    is_active: true,
                    sku: "LQ-SCARF-001",
                    created_at: "2024-02-01"
                },
                {
                    id: 5,
                    name: "Merino Wool Sweater",
                    price: 32000,
                    category_id: 3,
                    category_name: "Knitwear",
                    description: "Ultra-soft merino wool sweater with contemporary fit, available in seasonal colors.",
                    image_url: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=400&fit=crop",
                    stock: 20,
                    is_featured: false,
                    is_active: true,
                    sku: "LQ-SWEATER-001",
                    created_at: "2024-02-05"
                },
                {
                    id: 6,
                    name: "Designer Sunglasses",
                    price: 28000,
                    category_id: 1,
                    category_name: "Accessories",
                    description: "UV-protection sunglasses with acetate frames, combining style and functionality.",
                    image_url: "https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=400&h=400&fit=crop",
                    stock: 18,
                    is_featured: false,
                    is_active: true,
                    sku: "LQ-SUNGLASS-001",
                    created_at: "2024-02-10"
                }
            ];

            // サンプルカテゴリデータ
            categories = [
                { id: 1, name: "Accessories", description: "Luxury accessories for sophisticated lifestyle" },
                { id: 2, name: "Outerwear", description: "Premium coats and jackets for all seasons" },
                { id: 3, name: "Knitwear", description: "Soft and comfortable knitwear collection" },
                { id: 4, name: "Footwear", description: "Handcrafted shoes and boots" },
                { id: 5, name: "Jewelry", description: "Fine jewelry and precious accessories" }
            ];
        }

        // セクション表示制御
        function showSection(sectionName) {
            // 全セクションを非表示
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            
            // 指定されたセクションを表示
            const targetSection = document.getElementById(sectionName + 'Section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            } else {
                document.getElementById('homeSection').classList.remove('hidden');
            }
            
            // 商品一覧セクションの場合、商品を読み込み
            if (sectionName === 'collection') {
                loadAllProducts();
                loadCategoryFilter();
            } else if (sectionName === 'categories') {
                loadAllCategories();
            }
        }

        function goHome() {
            showSection('home');
        }

        // 商品表示関数
        function loadFeaturedProducts() {
            const featuredProducts = products.filter(p => p.is_featured && p.is_active);
            const container = document.getElementById('featuredProducts');
            
            container.innerHTML = featuredProducts.map(product => createProductCard(product)).join('');
        }

        function loadAllProducts() {
            const container = document.getElementById('productsContainer');
            const activeProducts = products.filter(p => p.is_active);
            
            container.innerHTML = activeProducts.slice(0, productsPerPage * currentPage)
                .map(product => createProductCard(product)).join('');
            
            // Load More ボタンの表示制御
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (activeProducts.length > productsPerPage * currentPage) {
                loadMoreBtn.style.display = 'block';
            } else {
                loadMoreBtn.style.display = 'none';
            }
        }

        function createProductCard(product) {
            return `
                <div class="group relative ${isEditMode ? 'edit-mode-product' : ''}" data-product-id="${product.id}">
                    ${isEditMode ? `
                        <div class="absolute top-2 right-2 z-10 flex space-x-1">
                            <button onclick="editProduct(${product.id})" class="bg-admin-blue text-white p-2 rounded-full opacity-90 hover:opacity-100">
                                <i class="fas fa-edit text-xs"></i>
                            </button>
                            <button onclick="deleteProductConfirm(${product.id})" class="bg-red-600 text-white p-2 rounded-full opacity-90 hover:opacity-100">
                                <i class="fas fa-trash text-xs"></i>
                            </button>
                        </div>
                    ` : ''}
                    <div class="aspect-[4/5] bg-gray-100 rounded-lg overflow-hidden group-hover:opacity-75 transition-opacity cursor-pointer" onclick="viewProduct(${product.id})">
                        <img src="${product.image_url}" alt="${product.name}" class="w-full h-full object-cover">
                    </div>
                    <div class="mt-4">
                        <h3 class="text-sm font-medium text-loewe-black cursor-pointer hover:text-loewe-brown transition-colors" onclick="viewProduct(${product.id})">${product.name}</h3>
                        <p class="text-sm text-loewe-gray mt-1">${product.category_name}</p>
                        <p class="text-lg font-medium text-loewe-black mt-2">¥${product.price.toLocaleString()}</p>
                        ${product.stock <= 5 ? `<p class="text-xs text-red-600 mt-1">Only ${product.stock} left</p>` : ''}
                        <button onclick="addToCart(${product.id})" class="mt-3 w-full border border-loewe-black text-loewe-black py-2 text-sm hover:bg-loewe-black hover:text-white transition-all ${product.stock === 0 ? 'opacity-50 cursor-not-allowed' : ''}" ${product.stock === 0 ? 'disabled' : ''}>
                            ${product.stock === 0 ? 'Out of Stock' : 'Add to Cart'}
                        </button>
                    </div>
                </div>
            `;
        }

        // カテゴリ表示
        function loadCategories() {
            const container = document.getElementById('categoriesContainer');
            
            container.innerHTML = categories.slice(0, 5).map(category => `
                <div class="text-center cursor-pointer group" onclick="filterByCategory(${category.id})">
                    <div class="w-full h-32 bg-gray-200 rounded-lg mb-4 group-hover:bg-gray-300 transition-colors"></div>
                    <h4 class="text-sm font-medium text-loewe-black group-hover:text-loewe-brown transition-colors">${category.name}</h4>
                </div>
            `).join('');
        }

        function loadAllCategories() {
            const container = document.getElementById('allCategoriesContainer');
            
            container.innerHTML = categories.map(category => {
                const categoryProducts = products.filter(p => p.category_id === category.id && p.is_active);
                return `
                    <div class="border border-gray-200 rounded-lg p-6 hover:shadow-lg transition-shadow cursor-pointer" onclick="filterByCategory(${category.id})">
                        <h4 class="text-lg font-medium text-loewe-black mb-2">${category.name}</h4>
                        <p class="text-sm text-loewe-gray mb-4">${category.description}</p>
                        <p class="text-xs text-loewe-gray">${categoryProducts.length} products</p>
                    </div>
                `;
            }).join('');
        }

        // 検索・フィルタリング
        function searchProducts(event) {
            if (event && event.key !== 'Enter') return;
            
            const query = document.getElementById('searchInput').value.toLowerCase();
            const filteredProducts = products.filter(p => 
                p.is_active && 
                (p.name.toLowerCase().includes(query) || 
                 p.description.toLowerCase().includes(query) ||
                 p.category_name.toLowerCase().includes(query))
            );
            
            displayProducts(filteredProducts);
        }

        function filterByCategory(categoryId) {
            showSection('collection');
            document.getElementById('categoryFilter').value = categoryId;
            filterProducts();
        }

        function filterProducts() {
            const categoryId = document.getElementById('categoryFilter').value;
            const priceRange = document.getElementById('priceFilter').value;
            
            let filteredProducts = products.filter(p => p.is_active);
            
            if (categoryId) {
                filteredProducts = filteredProducts.filter(p => p.category_id == categoryId);
            }
            
            if (priceRange) {
                const [min, max] = priceRange.split('-');
                if (max === undefined) {
                    filteredProducts = filteredProducts.filter(p => p.price >= parseInt(min));
                } else {
                    filteredProducts = filteredProducts.filter(p => p.price >= parseInt(min) && p.price <= parseInt(max));
                }
            }
            
            displayProducts(filteredProducts);
        }

        function sortProducts() {
            const sortBy = document.getElementById('sortSelect').value;
            let sortedProducts = [...products.filter(p => p.is_active)];
            
            switch(sortBy) {
                case 'price_asc':
                    sortedProducts.sort((a, b) => a.price - b.price);
                    break;
                case 'price_desc':
                    sortedProducts.sort((a, b) => b.price - a.price);
                    break;
                case 'name':
                    sortedProducts.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'featured':
                    sortedProducts.sort((a, b) => b.is_featured - a.is_featured);
                    break;
                case 'newest':
                default:
                    sortedProducts.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                    break;
            }
            
            displayProducts(sortedProducts);
        }

        function displayProducts(productList) {
            const container = document.getElementById('productsContainer');
            container.innerHTML = productList.slice(0, productsPerPage * currentPage)
                .map(product => createProductCard(product)).join('');
        }

        function loadCategoryFilter() {
            const select = document.getElementById('categoryFilter');
            select.innerHTML = '<option value="">All Categories</option>' +
                categories.map(cat => `<option value="${cat.id}">${cat.name}</option>`).join('');
        }

        function clearFilters() {
            document.getElementById('categoryFilter').value = '';
            document.getElementById('priceFilter').value = '';
            document.getElementById('searchInput').value = '';
            loadAllProducts();
        }

        // ショッピングカート機能
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product || product.stock === 0) return;
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                if (existingItem.quantity < product.stock) {
                    existingItem.quantity++;
                } else {
                    alert('在庫が不足しています');
                    return;
                }
            } else {
                cart.push({
                    ...product,
                    quantity: 1
                });
            }
            
            saveCartToStorage();
            updateCartUI();
            
            // 追加アニメーション
            showNotification(`${product.name} をカートに追加しました`);
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveCartToStorage();
            updateCartUI();
            updateCartDisplay();
        }

        function updateCartQuantity(productId, quantity) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                const product = products.find(p => p.id === productId);
                if (quantity <= 0) {
                    removeFromCart(productId);
                } else if (quantity <= product.stock) {
                    item.quantity = quantity;
                    saveCartToStorage();
                    updateCartUI();
                    updateCartDisplay();
                } else {
                    alert('在庫が不足しています');
                }
            }
        }

        function clearCart() {
            cart = [];
            saveCartToStorage();
            updateCartUI();
            updateCartDisplay();
        }

        function updateCartUI() {
            const cartCount = document.getElementById('cartCount');
            const cartTotal = document.getElementById('cartTotal');
            const checkoutBtn = document.getElementById('checkoutBtn');
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            if (totalItems > 0) {
                cartCount.textContent = totalItems;
                cartCount.classList.remove('hidden');
            } else {
                cartCount.classList.add('hidden');
            }
            
            if (cartTotal) {
                cartTotal.textContent = `¥${totalPrice.toLocaleString()}`;
            }
            
            if (checkoutBtn) {
                checkoutBtn.disabled = cart.length === 0;
            }
        }

        function updateCartDisplay() {
            const container = document.getElementById('cartItems');
            
            if (cart.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-shopping-bag text-4xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500">Your cart is empty</p>
                        <button onclick="closeCart(); showSection('collection')" class="mt-4 text-loewe-black hover:text-loewe-brown text-sm">
                            Continue Shopping
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = cart.map(item => `
                <div class="flex items-center space-x-4 py-4 border-b border-gray-200">
                    <img src="${item.image_url}" alt="${item.name}" class="w-16 h-16 object-cover rounded">
                    <div class="flex-1">
                        <h4 class="text-sm font-medium text-gray-900">${item.name}</h4>
                        <p class="text-sm text-gray-500">¥${item.price.toLocaleString()}</p>
                        <div class="flex items-center mt-2">
                            <button onclick="updateCartQuantity(${item.id}, ${item.quantity - 1})" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-minus text-xs"></i>
                            </button>
                            <span class="mx-3 text-sm">${item.quantity}</span>
                            <button onclick="updateCartQuantity(${item.id}, ${item.quantity + 1})" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-plus text-xs"></i>
                            </button>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-medium">¥${(item.price * item.quantity).toLocaleString()}</p>
                        <button onclick="removeFromCart(${item.id})" class="text-red-400 hover:text-red-600 text-xs mt-1">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function openCart() {
            updateCartDisplay();
            document.getElementById('cartSidebar').classList.remove('translate-x-full');
            document.getElementById('cartOverlay').classList.remove('hidden');
        }

        function closeCart() {
            document.getElementById('cartSidebar').classList.add('translate-x-full');
            document.getElementById('cartOverlay').classList.add('hidden');
        }

        // ストレージ機能
        function saveCartToStorage() {
            localStorage.setItem('lovequeenCart', JSON.stringify(cart));
        }

        function loadCartFromStorage() {
            const savedCart = localStorage.getItem('lovequeenCart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
            }
        }

        // 管理機能
        function toggleEditMode() {
            isEditMode = !isEditMode;
            const btn = document.getElementById('editModeBtn');
            const fab = document.getElementById('addProductFab');
            const editControls = document.querySelectorAll('.edit-controls');
            
            if (isEditMode) {
                btn.innerHTML = '<i class="fas fa-edit mr-1"></i>編集モード: ON';
                fab.classList.remove('hidden');
                editControls.forEach(control => control.classList.remove('hidden'));
                document.body.classList.add('edit-mode');
            } else {
                btn.innerHTML = '<i class="fas fa-edit mr-1"></i>編集モード: OFF';
                fab.classList.add('hidden');
                editControls.forEach(control => control.classList.add('hidden'));
                document.body.classList.remove('edit-mode');
            }
            
            // 商品カードを再描画
            if (document.getElementById('collectionSection').classList.contains('section-content') && 
                !document.getElementById('collectionSection').classList.contains('hidden')) {
                loadAllProducts();
            }
            loadFeaturedProducts();
        }

        // 管理者パネル
        function showAdminPanel() {
            document.getElementById('adminPanel').classList.remove('hidden');
            loadAdminData();
        }

        function closeAdminPanel() {
            document.getElementById('adminPanel').classList.add('hidden');
        }

        function showAdminTab(tabName) {
            // タブボタンの状態更新
            document.querySelectorAll('.admin-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // タブコンテンツの表示切り替え
            document.querySelectorAll('.admin-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`admin${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`).classList.remove('hidden');
            
            // データ読み込み
            if (tabName === 'products') {
                loadAdminProducts();
            } else if (tabName === 'analytics') {
                loadAnalytics();
            }
        }

        function loadAdminData() {
            loadAdminProducts();
            loadAnalytics();
        }

        function loadAdminProducts() {
            const tbody = document.getElementById('adminProductsTable');
            
            tbody.innerHTML = products.map(product => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <img class="h-10 w-10 rounded object-cover" src="${product.image_url}" alt="${product.name}">
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${product.name}</div>
                                <div class="text-sm text-gray-500">${product.sku || '-'}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">¥${product.price.toLocaleString()}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="text-sm ${product.stock <= 5 ? 'text-red-600 font-medium' : 'text-gray-900'}">${product.stock}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${product.is_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${product.is_active ? 'Published' : 'Draft'}
                        </span>
                        ${product.is_featured ? '<span class="ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Featured</span>' : ''}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editProduct(${product.id})" class="text-indigo-600 hover:text-indigo-900 mr-4">Edit</button>
                        <button onclick="deleteProductConfirm(${product.id})" class="text-red-600 hover:text-red-900">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        function loadAnalytics() {
            // 模擬分析データ
            const totalSales = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const totalOrders = Math.floor(Math.random() * 150) + 50;
            const totalCustomers = Math.floor(Math.random() * 80) + 20;
            
            document.getElementById('totalSales').textContent = `¥${totalSales.toLocaleString()}`;
            document.getElementById('totalOrders').textContent = totalOrders;
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('totalCustomers').textContent = totalCustomers;
        }

        // 商品編集
        function openProductModal(productId = null) {
            const modal = document.getElementById('productModal');
            const title = document.getElementById('productModalTitle');
            const form = document.getElementById('productForm');
            const deleteBtn = document.getElementById('deleteProductBtn');
            
            form.reset();
            
            if (productId) {
                const product = products.find(p => p.id === productId);
                if (product) {
                    title.textContent = 'Edit Product';
                    deleteBtn.classList.remove('hidden');
                    
                    // フォームにデータを設定
                    document.getElementById('productName').value = product.name;
                    document.getElementById('productPrice').value = product.price;
                    document.getElementById('productCategory').value = product.category_id;
                    document.getElementById('productDescription').value = product.description || '';
                    document.getElementById('productSku').value = product.sku || '';
                    document.getElementById('productStock').value = product.stock;
                    document.getElementById('productWeight').value = product.weight || '';
                    document.getElementById('productFeatured').checked = product.is_featured;
                    document.getElementById('productActive').checked = product.is_active;
                }
            } else {
                title.textContent = 'Add New Product';
                deleteBtn.classList.add('hidden');
            }
            
            loadCategoriesForProductForm();
            modal.classList.remove('hidden');
        }

        function closeProductModal() {
            document.getElementById('productModal').classList.add('hidden');
        }

        function editProduct(productId) {
            openProductModal(productId);
        }

        function loadCategoriesForProductForm() {
            const select = document.getElementById('productCategory');
            select.innerHTML = '<option value="">Select Category</option>' +
                categories.map(cat => `<option value="${cat.id}">${cat.name}</option>`).join('');
        }

        // 画像プレビュー
        function previewImages(input) {
            const container = document.getElementById('imagePreviewContainer');
            const uploadArea = document.getElementById('imageUploadArea');
            
            if (input.files && input.files.length > 0) {
                container.innerHTML = '';
                container.classList.remove('hidden');
                uploadArea.classList.add('hidden');
                
                Array.from(input.files).forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const div = document.createElement('div');
                        div.className = 'relative';
                        div.innerHTML = `
                            <img src="${e.target.result}" class="w-full h-24 object-cover rounded border">
                            <button type="button" onclick="removeImagePreview(${index})" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                        container.appendChild(div);
                    };
                    reader.readAsDataURL(file);
                });
            }
        }

        // 商品フォーム送信
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveProduct();
        });

        function saveProduct() {
            const formData = new FormData(document.getElementById('productForm'));
            const productData = {
                name: formData.get('name'),
                price: parseInt(formData.get('price')),
                category_id: parseInt(formData.get('category_id')),
                description: formData.get('description'),
                sku: formData.get('sku'),
                stock: parseInt(formData.get('stock')),
                weight: formData.get('weight') ? parseInt(formData.get('weight')) : null,
                is_featured: formData.get('is_featured') ? true : false,
                is_active: formData.get('is_active') ? true : false,
                image_url: 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=400&h=400&fit=crop', // デフォルト画像
                category_name: categories.find(c => c.id === parseInt(formData.get('category_id')))?.name || '',
                created_at: new Date().toISOString()
            };
            
            // 編集か新規作成かを判断
            const title = document.getElementById('productModalTitle').textContent;
            if (title === 'Edit Product') {
                // 編集の場合、既存商品を更新
                const existingProductIndex = products.findIndex(p => p.name === productData.name);
                if (existingProductIndex !== -1) {
                    productData.id = products[existingProductIndex].id;
                    products[existingProductIndex] = productData;
                }
            } else {
                // 新規作成の場合
                productData.id = Math.max(...products.map(p => p.id)) + 1;
                products.push(productData);
            }
            
            closeProductModal();
            loadFeaturedProducts();
            if (!document.getElementById('collectionSection').classList.contains('hidden')) {
                loadAllProducts();
            }
            loadAdminProducts();
            
            showNotification('商品が保存されました');
        }

        function deleteProductConfirm(productId) {
            if (confirm('この商品を削除してもよろしいですか？')) {
                deleteProduct(productId);
            }
        }

        function deleteProduct(productId) {
            products = products.filter(p => p.id !== productId);
            
            closeProductModal();
            loadFeaturedProducts();
            if (!document.getElementById('collectionSection').classList.contains('hidden')) {
                loadAllProducts();
            }
            loadAdminProducts();
            
            showNotification('商品が削除されました');
        }

        // 認証機能（簡易版）
        function checkUserSession() {
            const savedUser = localStorage.getItem('lovequeenUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateAuthUI();
            }
        }

        function updateAuthUI() {
            const authButtons = document.getElementById('authButtons');
            const userMenu = document.getElementById('userMenu');
            const adminToolbar = document.getElementById('adminToolbar');
            const adminMenuItems = document.getElementById('adminMenuItems');
            
            if (currentUser) {
                authButtons.classList.add('hidden');
                userMenu.classList.remove('hidden');
                document.getElementById('userName').textContent = currentUser.name;
                
                if (currentUser.is_admin) {
                    adminToolbar.classList.remove('hidden');
                    adminMenuItems.classList.remove('hidden');
                }
            } else {
                authButtons.classList.remove('hidden');
                userMenu.classList.add('hidden');
                adminToolbar.classList.add('hidden');
            }
        }

        function adminLogin() {
            // 簡易管理者ログイン
            currentUser = {
                id: 1,
                name: 'Admin',
                email: 'admin@lovequeen.co.jp',
                is_admin: true
            };
            localStorage.setItem('lovequeenUser', JSON.stringify(currentUser));
            updateAuthUI();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('lovequeenUser');
            updateAuthUI();
            isEditMode = false;
            document.getElementById('editModeBtn').innerHTML = '<i class="fas fa-edit mr-1"></i>編集モード: OFF';
            document.getElementById('addProductFab').classList.add('hidden');
        }

        function adminLogout() {
            logout();
        }

        // その他のユーティリティ関数
        function showNotification(message) {
            // 簡易通知表示
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded shadow-lg z-50';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function setupEventListeners() {
            // ユーザーメニューの開閉
            document.getElementById('userMenuButton').addEventListener('click', function() {
                document.getElementById('userDropdown').classList.toggle('hidden');
            });
            
            // クリック外しでメニューを閉じる
            document.addEventListener('click', function(e) {
                if (!e.target.closest('#userMenu')) {
                    document.getElementById('userDropdown').classList.add('hidden');
                }
            });
            
            // 管理者ログイン（デモ用）
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                    adminLogin();
                }
            });
        }

        // モーダル関数（基本的なもの）
        function openLoginModal() {
            // ログインモーダルを開く（実装省略）
            console.log('Login modal opened');
        }

        function openRegisterModal() {
            // 登録モーダルを開く（実装省略）
            console.log('Register modal opened');
        }

        function viewProduct(productId) {
            // 商品詳細を表示（実装省略）
            console.log('View product:', productId);
        }

        function proceedToCheckout() {
            if (cart.length === 0) return;
            
            // チェックアウト処理（実装省略）
            alert('チェックアウト機能は開発中です');
        }

        function loadMoreProducts() {
            currentPage++;
            loadAllProducts();
        }

        // CSS スタイル
        const style = document.createElement('style');
        style.textContent = `
            .admin-tab-btn {
                flex: 1;
                padding: 12px 16px;
                text-align: center;
                font-medium: 500;
                color: #6b7280;
                background: transparent;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                transition: all 0.2s ease;
            }
            
            .admin-tab-btn:hover {
                color: #374151;
                background: #f9fafb;
            }
            
            .admin-tab-btn.active {
                color: white;
                background: #3b82f6;
            }
            
            .edit-mode-product {
                position: relative;
            }
            
            .edit-mode-product:hover {
                ring: 2px;
                ring-color: #3b82f6;
            }
            
            .editable {
                cursor: pointer;
                border-radius: 4px;
                transition: all 0.2s ease;
            }
            
            .editable:hover {
                background: rgba(59, 130, 246, 0.1);
                outline: 1px solid #3b82f6;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
